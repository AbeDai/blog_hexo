---
title: 读书笔记-美团架构升级
date: 2022-06-25 22:49:05
categories: 成长
---

### 背景 美团架构发展

![badf2d20605a6251e4b0008ae03a146c](/image/A9F2A754-25DF-4A43-B188-94B38D246AD9.png)

美团点评使客户端架构统一是希望得到这方面的收益，通过标准化，就可以实现三个统一：统一的基础设施、统一的逻辑分层、统一的开发范式。然后会带来四个明确的好处：

- 让一线开发人员聚焦在业务开发上；
- 可以实施灵活的人力调配；
- 可以用标准化的方式介入一个新的业务以支持其快速启动；
- 一旦实现了标准化，必然可以基于它做一些自动化的实现，可以把一些相对机械重复的事通过自动化去取代人工；

![c4d983c7508a42346c98079eaa919feb](/image/3671723F-CFD1-4C60-93AD-A326F4B359B3.png)

美团客户端架构发展分为三个阶段：

1. 蛮荒阶段：这个阶段并没有什么体系化的架构设计；
1. 标准化阶段：内部细分了三个小阶段，实现了业务隔离、基础设施复用、开发范式等。
1. 自动化是正在建设中的阶段，希望通过使用工程自动化的手段去持续提升效率。

### 详解 标准化阶段

##### 业务隔离

![91445185b664783a3840eeb27bf70dd2](/image/6DCFDC34-238E-4F19-9C0A-AFC3AB3B538B.png)

**实现思路**

美团主要通过分层和隔离的方式来解决问题，首先把跟各个业务都无关的和与各个业务都相关的公共基础设施定义为平台的基础设施。我们把一个平台做强，同时在这个平台的基础之上去构建各个业务，而且在业务里面进行有特色的垂直化建设，这个阶段会带来很明显的收益。

通过这样的平台设施，在一定程度上实现了复用和业务的积累，解决了业务之间的耦合，各个业务在物理上会隔离开，放到不同的代码仓库里面，只是在构建的时候把他们集成在一起，这种模式还有一个好处，就是为新业务的接入保持开放，任何一个新业务都可以按照规范轻松地接进来。

**落地方式**

如果想要达成这样的目的，首先应该开发一套标准的业务模板，所有的新业务都按照这个模板去开发，根据模板的内容去进行业务的定制，并且通过统一的方法来实现接入。让新业务去做小白鼠，根据业务发展，产品迭代去逐步更新业务架构。

**收益**

1. 首先是在业务层面实现了业务间的隔离，解除了业务间的干扰，再也不会看到改电影模块导致酒店模块出现故障的现象，也不会把外卖的东西展示到美食区；
1. 在工程层面上实现了工程标准化，使得新业务接入的方式是标准化的；
1. 在技术层面上实现了独立的编译和二进制的集成，一旦实现了业务间的独立编译，就可以利用分布式的系统进行多机构建，这样就可以极大地缩短应用的构建时间。

##### 统一开发范式

![16a52e61ef9b389871075a675eeb4964](/image/AD22D306-B916-45CC-A261-398C2AF47FF7.png)
![2d8eb57045699c2cb209e422c72cf042](/image/207A41E2-8F1C-4105-8A01-4A988AA95AC6.png)

在这里以一个实际页面为例，这是一个复杂的页面，这个页面天然地划分成若干块，从这几个角度上来讲，页面本身并不存在什么东西，所有东西都被放到模块里，经过这样的抽象，我们把页面上的每一块定义为一个模块，同时页面会退化成模块容器的概念。

**落地方式**

想实现统一开发范式也会存在一些困难，这里的困难和上文是一样的，主要有两点，第一，整体重构一遍成本极高，第二，业务永远不会等着技术，所以开发的同时要进行重构。他们只对新需求涉及的页面进行重构，客户端的代码总是很快地迭代到，借着产品迭代这样的时机把对应的架构重构做完。

**收益**

他们在设计统一开发范式的时候就设定了目标，他们希望对高级工程师的依赖能够降低，以及开发效率能够得到提升，提升的逻辑在于代码可以复用。

##### 多应用复用

略

### 读后感

##### 标准化1.0阶段

目前 Resso 的架构可以说还处在 标准化1.0 阶段。模块之间的耦合性还比较重，有可能会出现 模块能力相互影响的现象。目前 Resso 的业务组件已经做到了 api、impl 的拆分，并通过 gradle 插件 lint 的方式做到了各个 biz 之间 impl 的相互依赖。现在我们要做的，其实只有代码的剥离而已。

##### 标准化1.1阶段

统一开发范式之后，将复用级别从页面拆分到了组件粒度。通过这种方式，进一步做到了模块容器之间的解耦。降低了功能相互影响的风险，不容易相互印象，就降低了开发复杂度，进一步提升了开发效率。开发者只需要关注自己负责的模块，关注的 scope 小了，也就降低了开发门槛。

目前 Resso 还没有推动范式的落地，抖音、TT 已经有2-3年的推动经验，将这部分经验借鉴过来，推动落地。我理解是对 Resso 架构发展有所帮助的。


### 参考

https://www.infoq.cn/article/meituan-client-architecture