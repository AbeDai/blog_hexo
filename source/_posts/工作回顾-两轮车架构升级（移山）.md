---
title: 工作回顾 - 两轮车架构升级（移山）
date: 2022-03-16 20:40:19
categories: 回顾
---

### 背景

<img width="900" src="/image/060FBE35-8181-43AD-B1EA-9850665BF81D.png">

滴滴在2019年8月份，发起了 单车、电单车 合并为两轮车事业部的团队融合。青桔App 和 滴滴App 都可以完成 单车和电单车 的骑行工作。

虽然从产品形态上的确是完成了 单车 和 电单车 的业务融合。但是底层还是两套代码在进行需求迭代。业务迭代开发人效上都有很大的压力，相当于一个需求需要在 滴滴端、青桔端 开发两遍，测试也需要在两端各测一遍。

### 方案选型

##### 横向需求拉齐

- 技术沟通：选择将 滴滴端的 MVP 架构作为主线，迁移到 青桔端。在青桔端做适配层，来兼容适配滴滴端的上下文环境。
    <img width="500" src="/image/DF148FC5-9DEF-40FA-95C6-FC2D2BD0526C.png">
- 产品沟通：单车与电单车从流程上看，分为五大核心流程：拦截、开锁、骑行、支付、结束，从产品形态上看，核心流程的复用度最大。
    <img width="500" src="/image/E8BEB4D3-3858-40B3-8DA4-EA7C0FDCCFBA.png">
- 设计沟通：青桔端和滴滴端 虽然样式基本一致，但是主题还是有些偏差。其中包括：主题色、地图Mark图标等。需要做平台区分。
    <img width="500" src="/image/8BEF433C-5F60-4C8B-9E6D-B8BD79BD2847.png">
- 测试沟通：老流程需要保留，等上线验证新架构没问题之后，再进行老流程代码的移除。
    <img width="200" src="/image/773E2EF9-36B9-4A70-9E60-1A01927A468E.png">
- 数据沟通：统一后续使用 滴滴端的取数方式来进行数据统计。

### 技术方案

<img width="900" src="/image/803C64C9-E1AF-48B9-8C98-A7C71C014097.png">

### 亮点回顾

##### SPI面向接口解耦

<img width="900" src="/image/874DBC16-D7E9-4FE3-8FDF-A705C2E1171E.png">

基于 SPI 的接口抽象能力，我们实现了 主题样式统一、基础库用法统一 等功能。

##### Ammox 基础库沉淀

<img width="600" src="/image/08DE6FDC-173F-407E-B389-4B0772A0A936.png">

基础技术模块

<img width="1200" src="/image/A9A63D23-5A38-4AEB-87DC-85BD3639A846.png">

基础业务模块

<img width="1200" src="/image/3AF4DA2B-8C24-4D56-88EA-0E6EA162509B.png">

### 项目成果

<img width="900" src="/image/B92F956C-D4C2-484E-A2AD-19524D5FCE39.png">


